---
// Design System
import '../styles/header.css';
---

<header id="site-header" class="site-header">
  <nav class="site-nav">
    <button class="hamburger" aria-label="Toggle menu">
      <span></span>
      <span></span>
    </button>
    <a href="/" class="logo-container">
      <span class="logo">Akrad√©</span>
      <span class="tagline">Right Story. Perfect Strategy.</span>
    </a>
  </nav>
</header>

<!-- Mega Menu -->
<div class="mega-menu">
  <nav class="mega-menu-nav">
    <ul class="mega-menu-links">
      <li><a href="/about" class={Astro.url.pathname === '/about' ? 'active' : ''}>About</a></li>
      <li><a href="/what-we-offer" class={Astro.url.pathname === '/what-we-offer' ? 'active' : ''}>What We Offer</a></li>
      <li><a href="/contact" class={Astro.url.pathname === '/contact' ? 'active' : ''}>Contact</a></li>
    </ul>
  </nav>
</div>

<script>
  // Cache DOM queries
  const hamburger = document.querySelector('.hamburger');
  const megaMenu = document.querySelector('.mega-menu');
  const megaMenuLinks = document.querySelectorAll('.mega-menu a');

  // Only initialize if elements exist
  if (hamburger && megaMenu) {
    // Mega menu handlers - toggle with hamburger
    const toggleMenu = () => {
      const isOpen = megaMenu.classList.contains('open');

      if (isOpen) {
        megaMenu.classList.remove('open');
        hamburger.classList.remove('active');
        document.body.style.overflow = '';
      } else {
        megaMenu.classList.add('open');
        hamburger.classList.add('active');
        document.body.style.overflow = 'hidden';
      }
    };

    const closeMenuFn = () => {
      megaMenu.classList.remove('open');
      hamburger.classList.remove('active');
      document.body.style.overflow = '';
    };

    hamburger.addEventListener('click', toggleMenu);
    megaMenuLinks.forEach(link => link.addEventListener('click', closeMenuFn));

    // ESC key to close menu
    document.addEventListener('keydown', e => {
      if (e.key === 'Escape' && megaMenu.classList.contains('open')) closeMenuFn();
    });
  }
</script>
